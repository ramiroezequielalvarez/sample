var clientSolutions = new SqlKata.Query("LiabilityCashflowClientSolutions")
    .WhereTrue("LiabilityCashflowClientSolutions.Active")
    .Where(q => q
        .WhereNull("LiabilityCashflowClientSolutions.EndDate")
        .OrWhere("LiabilityCashflowClientSolutions.EndDate", ">", DateTime.UtcNow.AddDays(-1).Date))
    .SelectRaw(@"
        LiabilityCashflowClientSolutions.LiabilityCashflowGroupId AS ClientSolutionCashflowGroup,
        LiabilityCashflowClientSolutions.Active AS ClientSolutionCashflowGroupActive,
        STRING_AGG(ClientSolutions.Name, ', ') AS ClientSolutionName") // Concatenar nombres
    .Join("LiabilityCashflowGroups", "LiabilityCashflowGroups.Id", "LiabilityCashflowClientSolutions.LiabilityCashflowGroupId")
    .Where("LiabilityCashflowGroups.ClientId", "=", clientId)
    .GroupBy("LiabilityCashflowClientSolutions.LiabilityCashflowGroupId");
