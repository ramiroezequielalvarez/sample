var clientSolutions = new SqlKata.Query("LiabilityCashflowClientSolutions")
    .WhereTrue("LiabilityCashflowClientSolutions.Active")
    .Where(q => q
        .WhereNull("LiabilityCashflowClientSolutions.EndDate")
        .OrWhere("LiabilityCashflowClientSolutions.EndDate", ">", DateTime.UtcNow.AddDays(1).Date))
    .Select(
        "LiabilityCashflowClientSolutions.LiabilityCashflowGroupId as ClientSolutionCashflowGroup",
        "LiabilityCashflowClientSolutions.Active as ClientSolutionCashflowGroupActive",
        "ClientSolutions.Name as ClientSolutionName"
    )
    .Join(
        "LiabilityCashflowGroups",
        "LiabilityCashflowGroups.Id",
        "LiabilityCashflowClientSolutions.LiabilityCashflowGroupId"
    )
    .LeftJoin(
        "ClientSolutions",
        "ClientSolutions.EntityId",
        "LiabilityCashflowClientSolutions.ClientSolutionId"
    )
    .Where("LiabilityCashflowGroups.ClientId", "=", clientId)
    .GroupBy("LiabilityCashflowClientSolutions.LiabilityCashflowGroupId") // Agrupar para evitar duplicados
    .SelectRaw("MIN(LiabilityCashflowClientSolutions.Id) as MinId") // Selecciona solo la fila con el ID m√≠nimo
    .Distinct();
